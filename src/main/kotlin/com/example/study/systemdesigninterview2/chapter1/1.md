# 1장 근접성 서비스

## 1단계: 문제 이해 및 설계 범위 확정

모든 기능을 인터뷰 시간 내에 설계할 수는 없다.  
그러니 질문을 던져 설계 범위를 좁혀야 한다.  

- 사용자가 검색 반경을 지정할 수 있는가?
- 최대 허용 반경은 얼마인가?
- 사용자가 UI에서 검색 반경을 변경할 수 있는가?
- 사업장 정보는 어떻게 시스템에 추가, 삭제, 갱신되는가?
- 사업장 정보에 대한 작업 결과가 사용자에게 실시간으로 보여져야 하는가?
- 검색 결과를 항상 현재 위치 기준으로 유지하기 위해 화면을 자동 갱신해야 하는가?


### 기능 요구사항

- 사용자의 위치와 검색 반경 정보에 매치되는 사업장 목록 반환
- 사업장 소유주가 사업장 정보를 추가, 삭제, 갱신할 수 있고, 실시간으로 반영될 필요는 없음
- 고객은 사업장의 상세 정보를 볼 수 있음

### 비기능 요구사항

- 낮은 응답 지연
- 데이터 보호: 사용자 위치는 민감 정보
- 고가용성 및 규모 확장성

### 개략적 규모 추정

- DAU 1억 명
- 등록된 사업장 수는 2억 곳


## 2단계: 개략적 설계안 제시 및 동의 구하기

### API 설계


### 데이터 모델

#### 읽기/쓰기 비율

읽기 연산이 쓰기 연산에 비해 실행 빈도가 높음  
읽기 연산이 압도적인 시스템에는 MySQL 같은 관계형 데이터베이스가 바람직할 수 있다.  

> 일반적으로 Nosql이 읽기 처리에 강점이 있다고 하는데?  
> https://velog.io/@park2348190/%EB%85%BC%EB%AC%B8%EB%B2%88%EC%97%AD-SQL-vs-NoSQL-A-Performance-Comparison  
> https://stackoverflow.com/questions/9702643/mysql-vs-mongodb-1000-reads  

#### 데이터 스키마


### 개략적 설계

#### 위치 기반 서비스(LBS)

- 읽기 요청만 발생하는 서비스
- QPS가 높음
- stateless 서비스이므로 수평적 규모 확장이 쉬움

#### 사업장 서비스

- 주로 쓰기 요청을 처리하는 서비스
- QPS가 낮음
- 고객이 사업장 정보를 조회하므로 특정 시간대에 QPS가 높음

#### 데이터베이스 클러스터

master(write), slave(read)로 구성

#### 사업장 서비스와 LBS의 규모 확장성

오토 스케일링 등으로 트래픽에 대응


### 주변 사업장 검색 알고리즘



