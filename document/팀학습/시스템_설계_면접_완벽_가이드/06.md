# 06 기능적 분할을 위한 공통 서비스

## 6.1 다양한 서비스의 공통 기능

엔지니어가 각 서비스에 기능을 별도로 구현하면 작업이나 코드의 중복이 발생할 수 있다.  
부족한 엔지니어링 리소스가 더 많은 작업에 분산되므로 오류나 비효율성이 발생할 가능성이 높다.  

- 라이브러리
  - 라이브러리 업데이트를 하지 않으면 버그나 보안 문제가 있는 버전을 계속 실행하는 문제
  - 서비스를 실행하는 각 호스트도 라이브러리를 실행하므로 다른 기능을 독립적으로 확장하기 어려움
- API 게이트웨이
  - 여러 데이터 센터에 위치한 상태 비저장 경량 웹 서비스
  - 다른 프로그래밍 언어 가능
  - 가능한 단순해야 함

### 6.1.1 보안

- 인증
- 인가
- SSL 종료
- 서버 사이드 데이터 암호화


### 6.1.2 오류 검사

- 요청 유효성 검사
- 요청 중복 제거


### 6.1.3 성능과 가용성

- 캐싱
- 속도 제한, 스로틀링
- 요청 디스패칭
  - 벌크헤드
  - 서킷 브레이커


### 6.1.4 로깅과 분석


## 6.2 서비스 메시 / 사이드카 패턴

- 컨트롤 플레인
  - 프록시 구성
  - 외부 서비스와의 인터페이스
- 데이터 플레인
  - 파드
    - 엔보이 프록시 호스트
    - 서비스 호스트
- 관창 가능성 플레인
  - ELK
  - 분산 추적 (Zipkin, opentracing)
  - 프로메테우스

관리자는 컨트롤 플레인을 사용해 프록시를 관리하고 외부 서비스와 인터페이스할 수 있다.  

- 인증 기관에 연결해 인증서 얻기
- ID와 접근 제어 서비스에 연결해 환경 구성 관리
- 인증서 ID나 ID 접근 제어 서비스 구성을 프록시 호스트로 푸시


## 6.3 메타데이터 서비스

메타데이터 서비스는 시스템 내의 여러 구성 요소가 사용하는 정보를 저장한다.  
구성 요소들이 서로 정보를 전달할 때, 전체 데이터를 직접 넘기기보다 ID만 전달할 수 있다.  
ID를 받은 구성 요소는 메타데이터 서비스에 해당 ID에 대응하는 정보를 요청할 수 있다.  

컨슈머가 메시지를 소비할 때 해당 ID에 대응하는 HTML 파일을 메타데이터 서비스에 요청할 수 있다.  

메타데이터 서비스는 ID 조회를 위한 것이다.  


## 6.4 서비스 디스커버리

서비스 디스커버리는 클라이언트가 사용 가능한 서비스 호스트를 식별하는 방법이다.  
서비스 레지스트리는 서비스의 사용 가능한 호스트를 추적하는 데이터베이스다.  

- Spring CloudEurake
- k8s


## 6.5 기능적 분할과 다양한 프레임워크

### 6.5.1 앱의 기본 시스템 설계

### 6.5.2 웹 서버 앱의 목적

브라우저가 백엔드에 직접 요청하지 않는 이유는 무엇인가?  
백엔드가 REST 앱이라면 그 API 엔드포인트가 브라우저가 필요로 하는 정확한 데이터를 반환하지 않을 수 있다.  
브라우저는 여러 API 요청을 하고 필요 이상의 데이터를 가져와야 할 수 있다.  

GraphQL 앱은 필요한 데이터를 정확히 요청할 수 있지만, 엔드포인트 보호에는 REST보다 더 많은 작업이 필요하고 보안 취약점이 발생할 수 있다.  


### 6.5.3 웹과 모바일 프레임워크

#### 브라우저 앱 개발

- 브라우저/클라이언트 사이드
  - HTML
  - CSS
  - JavaScript
  - React
  - Angular
  - Vue.js
- 서버 사이드
  - Express
  - PHP

#### 모바일 앱 개발

- 코틀린
- 스위프트

#### 크로스 플랫폼 개발

- 리액트 네이티브
- 플러터

#### 백엔드 개발

- RPC
- REST
- GraphQL


