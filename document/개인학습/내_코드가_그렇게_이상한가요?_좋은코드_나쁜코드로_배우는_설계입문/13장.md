# 13장 모델링: 클래스 설계의 토대

모델링을 하지 않으면, 변경하기 어렵고 악마를 불러들이는 코드를 작성하기 쉽다.  

## 13.1 악마를 불러들이기 쉬운 User 클래스

User 클래스는 사양 변경이 굉장히 잦아서, 새로 추가된 인스턴스 변수의 NPE 등의 오류가 발생함  

## 13.2 모델링으로 접근해야 하는 구조

### 13.2.1 시스템이란?

시스템은 목적 달성을 위한 수단이다.  
기술의 본질은 능력을 확장하는 것이다.  

### 13.2.2 시스템 구조와 모델링

모델의 의도를 정의하고, 구조를 설계하는 것이 모델링이다.  
모델이란 특정 목적 달성을 위해 최소한으로 필요한 요소를 갖춘 것이다.  

### 13.2.3 소프트웨어 설계와 모델링

목적에 따라 상품의 모델이 달라진다.  


## 13.3 안 좋은 모델의 문제점과 해결 방법

User 클래스(모델)는 '여러 목적에 무리(사용자/법인)하게 사용되고 있으며, 모델링된 것처럼 보이지만 모델링되어 있지 않다.'라고 말할 수 있다.  
이런 모델을 일관성 없는 모델이라 부른다.  

### 13.3.1 User와 시스템의 관계

User가 무엇인지 고민해야 한다.  

### 13.3.2 가상 세계를 표현하는 정보 시스템

### 13.3.3 목적별로 모델링하기

사용자를 표현하는 수단은 목적에 따라 이름과 형태가 달라진다.  
절대 하나가 아니다.  

개인으로 사용하는 방법과 법인으로 사용하는 방법은 다르므로, 계정을 '개인 계정'과 '법인 계정'으로 나누어서 모델을 표현해야, 모델의 일관성 문제를 해결할 수 있다.  

'현실 세계에 있는 물리적인 존재(사용자)'와 '정보 시스템에 있는 모델'이 무조건 일대일 대응되지 않고, 일대다 대응되는 경우가 많다.  
설계 품질을 생각할 때 이 부분에 특히 주의해야 한다.  

User(사용자)라는 이름이 굉장히 애매모호하다.  
구체적이고, 의미 범위가 좁고, 목적을 나타내는 이름으로 다시 설계하는 것도 좋다.  

### 13.3.4 모델은 대상이 아니라 목적 달성의 수단

사용자와 상품 모두 단순한 '대상'으로 해석하면, 여기에 모든 목적이 담긴다.  
데이터는 거대해질 수밖에 없고, 일관성 없는 구조가 된다.  

**목적 중심으로 이름을 잘 설계하면, 목적을 달성하기에 적절한 모델을 설계할 수 있다.**

### 13.3.5 단일 책임이란 단일 목적

클래스를 '공통으로 사용 가능한 범용적인 부품으로 설계해야 한다'고 생각하는 분도 있을 것이다.  
하지만, 그렇지 않다.  
**특적 목적에 특화되게 설계해야, 변경하기 쉬운 고품질 구조를 갖게 된다.**

좋은 설계란 무엇인지 잘 이해하는 사람들로 구성된 설계 현장에서는 '책무를 잘 생각해서 설계하자'라는 말을 자주 주고 받는다.  

### 13.3.6 모델을 다시 확인하는 방법

- 해당 모델이 달성하려는 목적을 모두 찾아낸다.
- 목적별로 모델링을 다시 수정한다.
- 목적 중심 이름 설계를 기반으로 모델에 이름을 붙인다.
- 모델에 목적 이외의 요소가 들어가 있다면 다시 수정한다.

### 13.3.7 모델과 구현은 반드시 서로 피드백하기

모델이 클래스는 아니다.  
일반적으로 모델 하나는 여러 개의 클래스로 구현된다.  

클래스 설계와 구현에서 무언가를 깨닫는다면, 이를 모델에 피드백해야 한다.  
피드백하면 모델이 더 정확해진다.  
그러면 모델 구조를 개선할 수 있고, 개선된 모델은 마찬가지로 클래스와 코드 품질 향상에 기여한다.  

피드백을 하지 않으면, '모델의 구조'와 '소스 코드' 사이에 괴리가 생긴다.  


## 13.4 기능성을 좌우하는 모델링

기능성이란 소프트웨어의 품질 특성 중 하나로, '고객의 니즈를 만족하는 정도'를 의미한다.

### 13.4.1 숨어 있는 목적 파악하기

상품 구매는 법적으로 매매 계약이고, 법적으로 생각하면 무게가 완전히 달라진다.  
모델링을 할 때 고려해야 하는 구성 요소가 달라진다는 것이다.  

기능을 제대로 발휘하려면, '개념의 정체'와 '뒤에 숨어 있는 중요한 목적'을 잘 파악해야 한다.  

### 13.4.2 기능성을 혁신하는 '깊은 모델'

목적 달성 수단으로 해석하면, 추상화했을 때 모델의 확장성이 커진다.  

```
내부 결제 프로세스는 결제준비 > 결제생성 > 결제승인이라는 3댑스 구조로 정의함
결제수단 중에 가상계좌가 존재하고, 간편결제(카카오페이)와 프로세스 차이가 있음

그래서인지 팀 동료는 '가상계좌 발급'이라는 API를 만들고, 해당 API에서 결제준비와 결제생성을 처리하도록 구현함
문제는 이렇게 되면 간편결제와 가상계좌의 결제 플로우가 달라지게 되고, 새로운 개념(프로세스)가 생겨나게 됨

가상계좌는 고객이 돈을 입금(결제)하는 하위 수단(방법) 중 하나일 뿐, 결제와 동급의 레벨일 수 없다고 생각함
궁극적인 목적은 고객이 돈을 입금 하는 것이지, 가상계좌 사용이 아니기 때문

따라서 내부 결제 프로세스 3댑스 구조에 가상계좌 발급로직을 반영해야한다고 피드백을 드린 상황
```


