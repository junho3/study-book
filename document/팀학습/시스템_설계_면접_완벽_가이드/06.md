# 06 기능적 분할을 위한 공통 서비스

## 6.1 다양한 서비스의 공통 기능

엔지니어가 각 서비스에 기능을 별도로 구현하면 작업이나 코드의 중복이 발생할 수 있다.  
부족한 엔지니어링 리소스가 더 많은 작업에 분산되므로 오류나 비효율성이 발생할 가능성이 높다.  

- 라이브러리
  - 라이브러리 업데이트를 하지 않으면 버그나 보안 문제가 있는 버전을 계속 실행하는 문제
  - 서비스를 실행하는 각 호스트도 라이브러리를 실행하므로 다른 기능을 독립적으로 확장하기 어려움
- API 게이트웨이
  - 여러 데이터 센터에 위치한 상태 비저장 경량 웹 서비스
  - 다른 프로그래밍 언어 가능
  - 가능한 단순해야 함

### 6.1.1 보안

- 인증
- 인가
- SSL 종료
- 서버 사이드 데이터 암호화


### 6.1.2 오류 검사

- 요청 유효성 검사
- 요청 중복 제거


### 6.1.3 성능과 가용성

- 캐싱
- 속도 제한, 스로틀링
- 요청 디스패칭
  - 벌크헤드
  - 서킷 브레이커


### 6.1.4 로깅과 분석


## 6.2 서비스 메시 / 사이드카 패턴

- 컨트롤 플레인
  - 프록시 구성
  - 외부 서비스와의 인터페이스
- 데이터 플레인
  - 파드
    - 엔보이 프록시 호스트
    - 서비스 호스트
- 관창 가능성 플레인
  - ELK
  - 분산 추적 (Zipkin, opentracing)
  - 프로메테우스

관리자는 컨트롤 플레인을 사용해 프록시를 관리하고 외부 서비스와 인터페이스할 수 있다.  

- 인증 기관에 연결해 인증서 얻기
- ID와 접근 제어 서비스에 연결해 환경 구성 관리
- 인증서 ID나 ID 접근 제어 서비스 구성을 프록시 호스트로 푸시
