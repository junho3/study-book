# 01 시스템 설계 개념 둘러보기

## 1.1 트레이드오프 논의

시스템 설계는 과학이 아니라 예술이다.  
이는 완벽함을 추구하기보다는, 주어진 리소스와 시간 안에서 현재와 미래의 요구사항을 가장 잘 만족시키는 시스템을 설계하기 위해 트레이드오프와 타협이 필요하다는 의미다.  

## 1.2 이 책을 어떻게 읽어야 할까?

- 의사소통 능력
- 순발력
- 좋은 질문을 하는 능력
- 성과에 대한 불안감

## 1.3 이 책의 개요

## 1.4 시스템의 다양한 서비스 확장 방식

### 1.4.1 시작: 앱의 소규모 초기 배포

### 1.4.2 GeoDNS를 통한 확장

서비스가 특정 국가나 지역의 사용자를 대상으로 한다면 일반적으로 지연 시간을 최소화하기 위해 인근 데이터 센터에 서비스를 호스팅한다.  
GeoDNS를 사용해 사용자에게 가장 가까운 데이터 센터에 호스팅된 서비스의 IP 주소를 반환할 수 있다.  

### 1.4.3 캐싱 서비스 추가

### 1.4.4 콘텐츠 배포 네트워크(CDN)


### 1.4.5 수평적 확장과 클러스터 관리, 지속적 통합, 지속적 배포에 관한 간단한 논의

서비스의 확장 요구사항이 빠르게 변할 수 있으므로 클러스터 크기를 쉽게 조정할 수 있어야 한다.  

#### CI/CD와 코드로서의 인프라(Iac)

테라폼의 도메인 특화 언어 DSL로 작성되며 클라우드 API와 통신해 인프라를 프로비저닝한다.  
테라폼 구성에는 일부 벤더 특화 코드가 포함될 수 있는데, 이를 최소화해야 벤더 종속성이 줄어든다.  

#### 점진적 롤아웃과 롤백

클라이언트가 새 빌드 버전으로 라우팅되는 요청을 보내고 시간 초과가 발생하면 클라이언트는 캐시에서 읽거나 요청을 반복해 이전 버전의 빌드가 있는 호스트로 라우팅될 수 있다.  

#### 실험

- A/B 테스트
- 멀티암드 밴딧


### 1.4.6 기능적 분할과 교차 관심사의 중앙 집중화

#### 공유 서비스

집킨이나 예거와 같은 분산 추적 시스템이나 분산 로깅을 사용해 요청이 수많은 서비스를 통과하는 과정을 추적한다.  
서비스는 각 요청에 스팬 ID를 첨부해 이를 추적으로 조립하고 분석할 수 있게 한다.  

#### API 게이트웨이

일부 API를 외부 개발자에게 노출하기 위해 API 게이트웨이 계층을 개발한다.  
- 인가와 인증
- 로깅, 모니터링, 경보
- 속도 제한
- 요금 청구
- 분석

API 게이트웨이 호스트와 서비스 호스트가 다른 데이터 센터에 있을 수 있다.  
해결책은 사이드카 패턴이라고 불리는 서비스 메시를 사용하는 것이다.  
각 서비스의 모든 호스트는 주 서비스와 함께 사이드카를 실행할 수 있고 쿠버네티스 파드를 사용한다.  
서비스와 사이드카는 같은 호스트에 있으므로 로컬 호스트를 통해 서로 주소를 지정할 수 있고 네트워크 지연이 없다.  

#### 사이드카 없는 서비스 메시 - 최신 기술

사이드카 프록시 로직을 서비스 호스트에 요청을 보내는 클라이언트 호스트에 배치해 이러한 복잡성을 줄일 수 있다.  

#### 명령 쿼리 책임 분리(CQRS)

에어비앤비 호스트는 목록 서비스에 쓰지만 방문자는 예약 서비스에서 읽는다.  


### 1.4.7 배치 및 스트리밍 추출, 변환, 적재(ETL)

- Kafka
- AWS Kinesis
- Airflow
- Flink

### 1.4.8 기타 필요 서비스

### 1.4.9 클라우드 vs 베어 메탈

### 1.4.10 서버리스: 서비스로서의 함수(FaaS)

특정 엔드포인트나 함수를 자주 사용하지 않거나 엄격한 지연 시간 요구사항이 없다면 함수 플랫폼에서 구현하는 것이 더 저렴할 수 있다.  
- AWS Lambda
- Azure Functions

람다 함수는 15분의 시간 제한이 있다.  

자바 프레임워크처럼 시작하는 데 몇 분이 걸리는 프레임워크는 FaaS에 적합하지 않을 수 있다.  
이로 인해 GraalVM과 같은 빠른 시작과 낮은 메모리 사용량을 가진 JDK가 출시됐다.

### 1.4.11 결론: 백엔드 서비스 확장

- 기능적 분할과 관심사의 중앙 집중화는 시스템 설계의 핵심 요소다.  
